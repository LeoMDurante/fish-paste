ggplot(p, aes(fill = Prevalence, y = prev, x = year)) +
facet_grid(~.type) +
geom_rect(data=p, type=="Fixed sites"), aes(fill=type),xmin= -Inf, xmax= Inf, ymin= -Inf, ymax=Inf, fill='light gray')+
geom_bar(stat="identity")
View(p)
ggplot(p, aes(fill = Prevalence, y = prev, x = year)) +
facet_grid(~.type) +
geom_bar(stat="identity"), position = position_dodge(), colour="black")
ggplot(health[ which(health$islacode == "PAL"),], aes(fill = Prevalence, y = prev, x = year)) +
facet_grid(~.type) +
geom_rect(data=subset(health[ which(health$islacode == "PAL"),], type=="Fixed sites"), aes(fill=type),xmin= -Inf, xmax= Inf, ymin= -Inf, ymax=Inf, fill='light gray')+
geom_bar(stat="identity", position = position_dodge(), colour="black") +
scale_y_continuous(breaks=waiver())
ggplot(health[ which(health$islacode == "PAL"),], aes(fill = Prevalence, y = prev, x = year)) +
facet_grid(~.type) +
geom_rect(data=subset(health[ which(health$islacode == "PAL"),], type=="Fixed sites"), aes(fill=type),xmin= -Inf, xmax= Inf, ymin= -Inf, ymax=Inf, fill='light gray')+
geom_bar(stat="identity", position = position_dodge(), colour="black") +
scale_y_continuous(breaks=waiver()) +
geom_errorbar(aes(ymin=prev - prev_se, ymax=prev + prev_se), position = position_dodge, width=0.3) +
#scale_fill_manual(values = c("springgreen1", "springgreen4")) +
facet_grid(~ type, scales ="free", space = "free") +
theme_bw()
ggplot(p, aes(fill = Prevalence, y = prev, x = year)) +
facet_grid(~.type) +
geom_rect(data=p, type=="Fixed sites"), aes(fill=type),xmin= -Inf, xmax= Inf, ymin= -Inf, ymax=Inf, fill='light gray')+
geom_bar(stat="identity"), position = position_dodge(), colour="black") +
scale_y_continuous(breaks=waiver()) +
geom_errorbar(aes(ymin=prev - prev_se, ymax=prev + prev_se), position = position_dodge, width=0.3) +
#scale_fill_manual(values = c("springgreen1", "springgreen4")) +
facet_grid(~ type, scales ="free", space = "free") +
theme_bw()
ggplot(p, aes(fill = Prevalence, y = prev, x = year)) +
facet_grid(~.type) +
geom_rect(data=p, type=="Fixed sites"), aes(fill=type),xmin= -Inf, xmax= Inf, ymin= -Inf, ymax=Inf, fill='light gray')+
geom_bar(stat="identity"), position = position_dodge(), colour="black") +
#scale_y_continuous(breaks=waiver()) +
geom_errorbar(aes(ymin=prev - prev_se, ymax=prev + prev_se), position = position_dodge, width=0.3) +
#scale_fill_manual(values = c("springgreen1", "springgreen4")) +
facet_grid(~ type, scales ="free", space = "free") +
theme_bw()
ggplot(p, aes(fill = Prevalence, y = prev, x = year)) +
facet_grid(~.type) +
geom_rect(data=p, type=="Fixed sites"), aes(fill=type),xmin= -Inf, xmax= Inf, ymin= -Inf, ymax=Inf, fill='light gray')+
geom_bar(stat="identity"), position = position_dodge(), colour="black") +
scale_y_continuous(breaks=waiver()) +
#geom_errorbar(aes(ymin=prev - prev_se, ymax=prev + prev_se), position = position_dodge, width=0.3) +
#scale_fill_manual(values = c("springgreen1", "springgreen4")) +
facet_grid(~ type, scales ="free", space = "free") +
theme_bw()
ggplot(p, aes(fill = Prevalence, y = prev, x = year)) +
facet_grid(~.type) +
geom_rect(data=p, type=="Fixed sites"), aes(fill=type),xmin= -Inf, xmax= Inf, ymin= -Inf, ymax=Inf, fill='light gray')+
geom_bar(stat="identity"), position = position_dodge(), colour="black") +
#scale_y_continuous(breaks=waiver()) +
#geom_errorbar(aes(ymin=prev - prev_se, ymax=prev + prev_se), position = position_dodge, width=0.3) +
#scale_fill_manual(values = c("springgreen1", "springgreen4")) +
facet_grid(~ type, scales ="free", space = "free") +
theme_bw()
ggplot(p, aes(fill = Prevalence, y = prev, x = year))
+
facet_grid(~.type)
colnames(p)
head(p)
str(p)
ggplot(p, aes(fill = Prevalence, y = prev, x = year)) +
facet_grid(~.type) +
geom_rect(data=p, type=="Fixed sites"), aes(fill=type),xmin= -Inf, xmax= Inf, ymin= -Inf, ymax=Inf, fill='light gray')+
geom_bar(stat="identity"), position = position_dodge(), colour="black")
ggplot(p, aes(fill = Prevalence, y = prev, x = year)) +
facet_grid(~.type) +
geom_rect(data=p, type=="Fixed sites"), aes(fill=type),xmin= -Inf, xmax= Inf, ymin= -Inf, ymax=Inf, fill='light gray')+
geom_bar(stat="identity", position = position_dodge(), colour="black") +
#scale_y_continuous(breaks=waiver()) +
#geom_errorbar(aes(ymin=prev - prev_se, ymax=prev + prev_se), position = position_dodge, width=0.3) +
#scale_fill_manual(values = c("springgreen1", "springgreen4")) +
facet_grid(~ type, scales ="free", space = "free") +
theme_bw()+
theme(
panel.border = element_rect(colour="dark gray"),
panel.grid.major = element_blank(),
panel.grid.minor = element_blank(),
legend.position="right",
legend.title = element_blank(),
axis.title = element_text(size = 15),
axis.text.x = element_text(angle = 0, vjust= 1, hjust=0.5, size = 15, colour="black"),
axis.text.y = element_text(angle = 0, hjust=0.5, size = 15, colour="black"),
strip.text.y = element_text(angle = 0, size = 15),
strip.text = element_text(size=15)) +
theme(axis.text.y=element_text(colour="black")) +
labs(y = "Prevalence (%)", x = NULL) +
theme(strip.text.x = element_text(margin = margin(.1, 0, .1, 0, "cm")))+
scale_y_continuous(labels = scaleFUN)
ggplot(p, aes(fill = Prevalence, y = prev, x = year)) +
facet_grid(~.type) +
geom_rect(data=p, type=="Fixed sites"), aes(fill=type),xmin= -Inf, xmax= Inf, ymin= -Inf, ymax=Inf, fill='light gray')+
geom_bar( position = position_dodge(), colour="black")
ggplot(health[ which(health$islacode == "PAL"),], aes(fill = Prevalence, y = prev, x = year)) +
facet_grid(~.type) +
geom_rect(data=subset(health[ which(health$islacode == "PAL"),], type=="Fixed sites"), aes(fill=type),xmin= -Inf, xmax= Inf, ymin= -Inf, ymax=Inf, fill='light gray')+
geom_bar(stat="identity", position = position_dodge(), colour="black")
ggplot(health[ which(health$islacode == "PAL"),], aes(fill = Prevalence, y = prev, x = year)) +
facet_grid(~.type) +
geom_rect(data=subset(health[ which(health$islacode == "PAL"),], type=="Fixed sites"), aes(fill=type),xmin= -Inf, xmax= Inf, ymin= -Inf, ymax=Inf, fill='light gray')+
geom_bar(stat="identity", position = position_dodge(), colour="black") +
scale_y_continuous(breaks=waiver()) +
geom_errorbar(aes(ymin=prev - prev_se, ymax=prev + prev_se), position = position_dodge, width=0.3) +
#scale_fill_manual(values = c("springgreen1", "springgreen4")) +
facet_grid(~ type, scales ="free", space = "free")
ggplot(health[ which(health$islacode == "PAL"),], aes(fill = Prevalence, y = prev, x = year)) +
facet_grid(~.type) +
geom_rect(data=subset(health[ which(health$islacode == "PAL"),], type=="Fixed sites"), aes(fill=type),xmin= -Inf, xmax= Inf, ymin= -Inf, ymax=Inf, fill='light gray')+
geom_bar(stat = "identity", position = position_dodge(), colour="black") +
scale_y_continuous(breaks=waiver()) +
geom_errorbar(aes(ymin=prev - prev_se, ymax=prev + prev_se), position = position_dodge, width=0.3) +
#scale_fill_manual(values = c("springgreen1", "springgreen4")) +
facet_grid(~ type, scales ="free", space = "free") +
theme_bw()
ggplot(health[ which(health$islacode == "PAL"),], aes(fill = Prevalence, y = prev, x = year)) +
facet_grid(~.type) +
geom_rect(data=subset(health[ which(health$islacode == "PAL"),], type=="Fixed sites"), aes(fill=type),xmin= -Inf, xmax= Inf, ymin= -Inf, ymax=Inf, fill='light gray')+
geom_bar(stat = "identity", position = position_dodge(), colour="black") +
scale_y_continuous(breaks=waiver()) +
geom_errorbar(aes(ymin=prev - prev_se, ymax=prev + prev_se), position = position_dodge, width=0.3) +
#scale_fill_manual(values = c("springgreen1", "springgreen4")) +
facet_grid(~ type, scales ="free", space = "free") +
theme_bw()+
theme(
panel.border = element_rect(colour="dark gray"),
panel.grid.major = element_blank(),
panel.grid.minor = element_blank(),
legend.position="right",
legend.title = element_blank(),
axis.title = element_text(size = 15),
axis.text.x = element_text(angle = 0, vjust= 1, hjust=0.5, size = 15, colour="black"),
axis.text.y = element_text(angle = 0, hjust=0.5, size = 15, colour="black"),
strip.text.y = element_text(angle = 0, size = 15),
strip.text = element_text(size=15)) +
theme(axis.text.y=element_text(colour="black")) +
labs(y = "Prevalence (%)", x = NULL) +
theme(strip.text.x = element_text(margin = margin(.1, 0, .1, 0, "cm")))
colnames(p)
ggplot(p, aes(fill = p$Prevalence, y = p$prev, x = p$year)) +
facet_grid(~.type) +
geom_rect(data=p, type=="Fixed sites"), aes(fill=type),xmin= -Inf, xmax= Inf, ymin= -Inf, ymax=Inf, fill='light gray')+
geom_bar( position = position_dodge(), colour="black") +
#scale_y_continuous(breaks=waiver()) +
#geom_errorbar(aes(ymin=prev - prev_se, ymax=prev + prev_se), position = position_dodge, width=0.3) +
#scale_fill_manual(values = c("springgreen1", "springgreen4")) +
facet_grid(~ type, scales ="free", space = "free") +
theme_bw()
ggplot(p, aes(fill = p$Prevalence, y = p$prev, x = p$year))
ggplot(p, aes(fill = Prevalence, y = prev, x = year)) +
facet_grid(~.type)
ggplot(p, aes(fill = Prevalence, y = prev, x = year)) +
facet_grid(~.type) +
geom_rect(data=p, type=="Fixed sites"), aes(fill=type),xmin= -Inf, xmax= Inf, ymin= -Inf, ymax=Inf, fill='light gray')+
geom_bar( position = position_dodge(), colour="black") +
#scale_y_continuous(breaks=waiver()) +
#geom_errorbar(aes(ymin=prev - prev_se, ymax=prev + prev_se), position = position_dodge, width=0.3) +
#scale_fill_manual(values = c("springgreen1", "springgreen4")) +
facet_grid(~ type, scales ="free", space = "free")
ggplot(p, aes(fill = Prevalence, y = prev, x = year)) +
facet_grid(~.type) +
#geom_rect(data=p, type=="Fixed sites"), aes(fill=type),xmin= -Inf, xmax= Inf, ymin= -Inf, ymax=Inf, fill='light gray')+
geom_bar( position = position_dodge(), colour="black") +
#scale_y_continuous(breaks=waiver()) +
#geom_errorbar(aes(ymin=prev - prev_se, ymax=prev + prev_se), position = position_dodge, width=0.3) +
#scale_fill_manual(values = c("springgreen1", "springgreen4")) +
facet_grid(~ type, scales ="free", space = "free")
View(p)
load("D:/CRED/PRIMNM_REPORT/data/PRIA Num Tows.RData") #n_tows
head(n_tows)
tow<-n_tows[,c("OBS_YEAR","Palmyra")]
names(tow)
colnames(tow)[2]<-"TOWS"
# load BLT and SPC data
load("D:/CRED/PRIMNM_REPORT/data/PRIA wsd.RData") # wsd
head(wsd)
wsd$COUNT<-1
# just get Palmyra
wd<-wsd[wsd$ISLAND=="Palmyra",]
library(plyr)
library(reshape)
# get number of sites by year and method
# avg_trips<-ddply(wd,.(YEAR_GROUP,HI_ISLND),summarize,"avg_trips"=mean(exp.trips))
sites<-ddply(wd,.(OBS_YEAR,METHOD), summarize, "nsites"=sum(COUNT))
# cast data into table
matrix<-cast(sites,OBS_YEAR~METHOD)
count<-merge(matrix,tow,by="OBS_YEAR")
head(count)
library(ggplot2)
library(reshape)
head(wsd)
pal<-wsd[wsd$ISLAND=="Palmyra",]
# load summary data
load("D:/CRED/PRIMNM_REPORT/data/PRIA ConsistentlySampledStrata CAPPED.Rdata") #dp
dp<-as.data.frame(dp)
pal<-dp[dp$Mean.ISLAND=="Palmyra",]
data<-pal
tmr<-data[c("Mean.ISLAND","Mean.ANALYSIS_YEAR", "Mean.METHOD","Mean.PRIMARY", "Mean.SECONDARY", "Mean.PISCIVORE", "Mean.PLANKTIVORE","Mean.TotFish","Mean.Scaridae")]
test<-melt(tmr, id=c("Mean.ISLAND", "Mean.ANALYSIS_YEAR","Mean.METHOD"))
names(test)<-c("Island", "OBS_YEAR","Method", "Analysisgroup", "Biomass")
tmr<-data[c("Mean.ISLAND","Mean.ANALYSIS_YEAR", "Mean.METHOD","PooledSE.PRIMARY", "PooledSE.SECONDARY", "PooledSE.PISCIVORE", "PooledSE.PLANKTIVORE","PooledSE.TotFish","PooledSE.Scaridae")]
test2<-melt(tmr, id=c("Mean.ISLAND", "Mean.ANALYSIS_YEAR","Mean.METHOD"))
names(test2)<-c("Island","ANALYSIS_YEAR", "Method","Analysisgroup", "SE")
# build data frame
dt<-as.data.frame(cbind(test, test2$SE))
names(dt)<-c("Island", "Year","Method","Analysisgroup", "Biomass", "SE")
levels(dt$Analysisgroup)<-c("Pri. cons.", "Sec. cons.", "Piscivores", "Planktivores", "All fishes","Parrotfishes")
# specify vertical order of facets
dt$Analysisgroup<-factor(dt$Analysisgroup, levels(dt$Analysisgroup)[c(4,1,2,3,6,5)])
##Define the top and bottom of the errorbars
limits <- aes(ymax = Biomass + SE, ymin=Biomass - SE)
dodge <- position_dodge(width=0.9)
base_size<-12
colours <- c("#fef0d9","#fdd49e","#fdbb84","#fc8d59","#e34a33","#b30000")
# change year to a factor so it will plot continuously
#dt$Year<-as.factor(dt$Year)
#shaded plot for blt data. first build backround data frame
# bar plot
p <- ggplot(dt, aes(fill=Analysisgroup, y=Biomass, x=Year)) +
geom_rect(data=subset(dt,Method=="BLT"), aes(fill=Method),xmin= -Inf, xmax= Inf, ymin= -Inf, ymax=Inf, fill='light gray')+
geom_bar( stat="identity", colour="black") +
scale_y_continuous(breaks=waiver())+#(breaks=c(0,25,50,75,100)) +
geom_errorbar(limits, position=dodge, width=0.25) +
scale_fill_manual(values = colours) +
facet_wrap(Analysisgroup ~ Method, scales ="free",ncol=2,labeller = function (labels) {
labels <- lapply(labels, as.character)
list(do.call(paste, c(labels, list(sep = ", ")))) }) +
theme_bw()+theme(panel.border = element_rect(colour="dark gray"), panel.grid.major = element_blank(), panel.grid.minor = element_blank(),legend.position="none", axis.text.x = element_text(angle = 0, vjust= 1, hjust=0.5, size = base_size*0.8, colour="black"), strip.text.y = element_text(angle = 0, size = base_size*0.8),strip.text = element_text(size=8))+
theme(axis.text.y=element_text(colour="black"))+
labs(y = expression(paste("Fish biomass (g ", m^-2,")")))+
theme(strip.text.x = element_text(margin = margin(.1, 0, .1, 0, "cm")))## or yellow red?? YlOrRd + facet_grid()
suppressMessages(ggsave(filename ="D:/CRED/PRIMNM_REPORT/figures/graph_trophic_palmyra_bar_free_scales.tiff", width=12, height = 20.0, units = c("cm")))
p
head(p)
head(p)
health<-read.csv("C:/Users/Kaylyn.McCoy/Documents/R_help/health.csv")
p<-health[health$islacode == "PAL",]
head(p)
ggplot(p, aes(fill = Prevalence, y = prev, x = year)) +
#facet_grid(~.type) +
geom_rect(data=p, type=="Fixed sites"), aes(fill=type),xmin= -Inf, xmax= Inf, ymin= -Inf, ymax=Inf, fill='light gray')+
geom_bar(stat = "identity", position = position_dodge(), colour="black")
ggplot(p, aes(fill = Prevalence, y = prev, x = year)) +
#facet_grid(~.type) +
geom_rect(data=p, type=="Fixed sites"), aes(fill=type),xmin= -Inf, xmax= Inf, ymin= -Inf, ymax=Inf, fill='light gray')+
geom_bar(stat = "identity", position = position_dodge(), colour="black") +
scale_y_continuous(breaks=waiver()) +
geom_errorbar(aes(ymin=prev - prev_se, ymax=prev + prev_se), position = position_dodge, width=0.3) +
#scale_fill_manual(values = c("springgreen1", "springgreen4")) +
facet_grid(~ type, scales ="free", space = "free")
ggplot(p, aes(fill = Prevalence, y = prev, x = year)) +
#facet_grid(~.type) +
geom_rect(data=p, type=="Fixed sites"), aes(fill=type),xmin= -Inf, xmax= Inf, ymin= -Inf, ymax=Inf, fill='light gray')+
geom_bar(stat = "identity", position = position_dodge(), colour="black") +
scale_y_continuous(breaks=waiver()) +
geom_errorbar(aes(ymin=prev - prev_se, ymax=prev + prev_se), position = position_dodge, width=0.3) +
#scale_fill_manual(values = c("springgreen1", "springgreen4")) +
facet_wrap(Prevalence~type, scales ="free", space = "free") +
theme_bw()
ggplot(p, aes(fill = Prevalence, y = prev, x = year)) +
#facet_grid(~.type) +
geom_rect(data=p, type=="Fixed sites"), aes(fill=type),xmin= -Inf, xmax= Inf, ymin= -Inf, ymax=Inf, fill='light gray')+
geom_bar(stat = "identity", colour="black") +
scale_y_continuous(breaks=waiver()) +
geom_errorbar(aes(ymin=prev - prev_se, ymax=prev + prev_se), position = position_dodge, width=0.3) +
#scale_fill_manual(values = c("springgreen1", "springgreen4")) +
facet_wrap(Prevalence~type, scales ="free", space = "free") +
theme_bw()
ggplot(p, aes(fill = Prevalence, y = prev, x = year)) +
#facet_grid(~.type) +
geom_rect(data=subset(p, type=="Fixed sites"), aes(fill=type),xmin= -Inf, xmax= Inf, ymin= -Inf, ymax=Inf, fill='light gray')+
geom_bar(stat = "identity", colour="black") +
scale_y_continuous(breaks=waiver()) +
geom_errorbar(aes(ymin=prev - prev_se, ymax=prev + prev_se), position = position_dodge, width=0.3) +
#scale_fill_manual(values = c("springgreen1", "springgreen4")) +
facet_wrap(Prevalence~type, scales ="free", space = "free")
ggplot(p, aes(fill = Prevalence, y = prev, x = year)) +
#facet_grid(~.type) +
geom_rect(data=subset(p, type=="Fixed sites"), aes(fill=type),xmin= -Inf, xmax= Inf, ymin= -Inf, ymax=Inf, fill='light gray')+
geom_bar(stat = "identity", colour="black") +
scale_y_continuous(breaks=waiver()) +
geom_errorbar(aes(ymin=prev - prev_se, ymax=prev + prev_se), position = position_dodge, width=0.3) +
#scale_fill_manual(values = c("springgreen1", "springgreen4")) +
facet_wrap(Prevalence~type, scales ="free")
ggplot(p, aes(fill = Prevalence, y = prev, x = year)) +
#facet_grid(~.type) +
geom_rect(data=subset(p, type=="Fixed sites"), aes(fill=type),xmin= -Inf, xmax= Inf, ymin= -Inf, ymax=Inf, fill='light gray')+
geom_bar(stat = "identity", colour="black") +
scale_y_continuous(breaks=waiver()) +
geom_errorbar(aes(ymin=prev - prev_se, ymax=prev + prev_se), position = position_dodge, width=0.3) +
#scale_fill_manual(values = c("springgreen1", "springgreen4")) +
facet_wrap(Prevalence~type, scales ="free")
ggplot(health[ which(health$islacode == "PAL"),], aes(fill = Prevalence, y = prev, x = year)) +
#facet_grid(~.type) +
geom_rect(data=subset(health[ which(health$islacode == "PAL"),], type=="Fixed sites"), aes(fill=type),xmin= -Inf, xmax= Inf, ymin= -Inf, ymax=Inf, fill='light gray')+
geom_bar(stat = "identity", position = position_dodge(), colour="black") +
scale_y_continuous(breaks=waiver()) +
geom_errorbar(aes(ymin=prev - prev_se, ymax=prev + prev_se), position = position_dodge, width=0.3) +
#scale_fill_manual(values = c("springgreen1", "springgreen4")) +
facet_grid(~ type, scales ="free", space = "free")
ggplot(health[ which(health$islacode == "PAL"),], aes(fill = Prevalence, y = prev, x = year)) +
#facet_grid(~.type) +
geom_rect(data=subset(health[ which(health$islacode == "PAL"),], type=="Fixed sites"), aes(fill=type),xmin= -Inf, xmax= Inf, ymin= -Inf, ymax=Inf, fill='light gray')+
geom_bar(stat = "identity", position = position_dodge(), colour="black") +
scale_y_continuous(breaks=waiver()) +
geom_errorbar(aes(ymin=prev - prev_se, ymax=prev + prev_se), position = position_dodge, width=0.3) +
#scale_fill_manual(values = c("springgreen1", "springgreen4")) +
facet_grid(Prevalence ~ type, scales ="free", space = "free")
ggplot(dt, aes(fill=Analysisgroup, y=Biomass, x=Year))
ggplot(dt, aes(fill=Analysisgroup, y=Biomass, x=Year)) +
geom_rect(data=subset(dt,Method=="BLT"), aes(fill=Method),xmin= -Inf, xmax= Inf, ymin= -Inf, ymax=Inf, fill='light gray')+
geom_bar( stat="identity", colour="black")
ggplot(health[ which(health$islacode == "PAL"),], aes(fill = Prevalence, y = prev, x = year))
ggplot(health[ which(health$islacode == "PAL"),], aes(fill = Prevalence, y = prev, x = year)) +
#facet_grid(~.type) +
geom_rect(data=subset(health[ which(health$islacode == "PAL"),], type=="Fixed sites"), aes(fill=type),xmin= -Inf, xmax= Inf, ymin= -Inf, ymax=Inf, fill='light gray')
ggplot(health[ which(health$islacode == "PAL"),], aes(fill = Prevalence, y = prev, x = year)) +
#facet_grid(~.type) +
geom_rect(data=subset(health[ which(health$islacode == "PAL"),], type=="Fixed sites"), aes(fill=type),xmin= -Inf, xmax= Inf, ymin= -Inf, ymax=Inf, fill='light gray')+
geom_bar(stat = "identity", position = position_dodge(), colour="black")
ggplot(dt, aes(fill=Analysisgroup, y=Biomass, x=Year)) +
geom_rect(data=subset(dt,Method=="BLT"), aes(fill=Method),xmin= -Inf, xmax= Inf, ymin= -Inf, ymax=Inf, fill='light gray')+
geom_bar( stat="identity", colour="black") +
scale_y_continuous(breaks=waiver())
ggplot(health[ which(health$islacode == "PAL"),], aes(fill = Prevalence, y = prev, x = year)) +
#facet_grid(~.type) +
geom_rect(data=subset(health[ which(health$islacode == "PAL"),], type=="Fixed sites"), aes(fill=type),xmin= -Inf, xmax= Inf, ymin= -Inf, ymax=Inf, fill='light gray')+
geom_bar(stat = "identity", position = position_dodge(), colour="black") +
scale_y_continuous(breaks=waiver())
ggplot(dt, aes(fill=Analysisgroup, y=Biomass, x=Year)) +
geom_rect(data=subset(dt,Method=="BLT"), aes(fill=Method),xmin= -Inf, xmax= Inf, ymin= -Inf, ymax=Inf, fill='light gray')+
geom_bar( stat="identity", colour="black") +
scale_y_continuous(breaks=waiver())+#(breaks=c(0,25,50,75,100)) +
geom_errorbar(limits, position=dodge, width=0.25)
ggplot(health[ which(health$islacode == "PAL"),], aes(fill = Prevalence, y = prev, x = year)) +
#facet_grid(~.type) +
geom_rect(data=subset(health[ which(health$islacode == "PAL"),], type=="Fixed sites"), aes(fill=type),xmin= -Inf, xmax= Inf, ymin= -Inf, ymax=Inf, fill='light gray')+
geom_bar(stat = "identity", position = position_dodge(), colour="black") +
scale_y_continuous(breaks=waiver()) +
geom_errorbar(aes(ymin=prev - prev_se, ymax=prev + prev_se), position = position_dodge, width=0.3)
limits <- aes(ymax=prev + prev_se, ymin=prev - prev_se)
dodge <- position_dodge(width=0.9)
base_size<-12
ggplot(health[ which(health$islacode == "PAL"),], aes(fill = Prevalence, y = prev, x = year)) +
#facet_grid(~.type) +
geom_rect(data=subset(health[ which(health$islacode == "PAL"),], type=="Fixed sites"), aes(fill=type),xmin= -Inf, xmax= Inf, ymin= -Inf, ymax=Inf, fill='light gray')+
geom_bar(stat = "identity", position = position_dodge(), colour="black") +
scale_y_continuous(breaks=waiver()) +
geom_errorbar(limits, position=dodge, width=0.25)
ggplot(health[ which(health$islacode == "PAL"),], aes(fill = Prevalence, y = prev, x = year)) +
#facet_grid(~.type) +
geom_rect(data=subset(health[ which(health$islacode == "PAL"),], type=="Fixed sites"), aes(fill=type),xmin= -Inf, xmax= Inf, ymin= -Inf, ymax=Inf, fill='light gray')+
geom_bar(stat = "identity", position = position_dodge(), colour="black") +
scale_y_continuous(breaks=waiver()) +
geom_errorbar(limits, position=dodge, width=0.25) +
#scale_fill_manual(values = c("springgreen1", "springgreen4")) +
facet_grid(Prevalence ~ type, scales ="free", space = "free") +
theme_bw()
ggplot(health[ which(health$islacode == "PAL"),], aes(fill = Prevalence, y = prev, x = year)) +
#facet_grid(~.type) +
geom_rect(data=subset(health[ which(health$islacode == "PAL"),], type=="Fixed sites"), aes(fill=type),xmin= -Inf, xmax= Inf, ymin= -Inf, ymax=Inf, fill='light gray')+
geom_bar(stat = "identity", position = position_dodge(), colour="black") +
scale_y_continuous(breaks=waiver()) +
geom_errorbar(limits, position=dodge, width=0.25) +
#scale_fill_manual(values = c("springgreen1", "springgreen4")) +
facet_grid(Prevalence ~ type, scales ="free", space = "free") +
theme_bw()+
theme(
panel.border = element_rect(colour="dark gray"),
panel.grid.major = element_blank(),
panel.grid.minor = element_blank(),
legend.position="right",
legend.title = element_blank(),
axis.title = element_text(size = 15),
axis.text.x = element_text(angle = 0, vjust= 1, hjust=0.5, size = 15, colour="black"),
axis.text.y = element_text(angle = 0, hjust=0.5, size = 15, colour="black"),
strip.text.y = element_text(angle = 0, size = 15),
strip.text = element_text(size=15)) +
theme(axis.text.y=element_text(colour="black")) +
labs(y = "Prevalence (%)", x = NULL) +
theme(strip.text.x = element_text(margin = margin(.1, 0, .1, 0, "cm")))+
scale_y_continuous(labels = scaleFUN)
ggplot(health[ which(health$islacode == "PAL"),], aes(fill = Prevalence, y = prev, x = year)) +
facet_grid(~.type) +
geom_rect(data=subset(health[ which(health$islacode == "PAL"),], type=="Fixed sites"), aes(fill=type),xmin= -Inf, xmax= Inf, ymin= -Inf, ymax=Inf, fill='light gray')+
geom_bar(stat = "identity", position = position_dodge(), colour="black") +
scale_y_continuous(breaks=waiver()) +
geom_errorbar(limits, position=dodge, width=0.25) +
#scale_fill_manual(values = c("springgreen1", "springgreen4")) +
facet_grid(Prevalence ~ type, scales ="free", space = "free") +
theme_bw()+
theme(
panel.border = element_rect(colour="dark gray"),
panel.grid.major = element_blank(),
panel.grid.minor = element_blank(),
legend.position="right",
legend.title = element_blank(),
axis.title = element_text(size = 15),
axis.text.x = element_text(angle = 0, vjust= 1, hjust=0.5, size = 15, colour="black"),
axis.text.y = element_text(angle = 0, hjust=0.5, size = 15, colour="black"),
strip.text.y = element_text(angle = 0, size = 15),
strip.text = element_text(size=15)) +
theme(axis.text.y=element_text(colour="black")) +
labs(y = "Prevalence (%)", x = NULL) +
theme(strip.text.x = element_text(margin = margin(.1, 0, .1, 0, "cm")))+
scale_y_continuous(labels = scaleFUN)
#  to use with cruise brief
library(maptools)
library(mapdata)
library(PBSmapping)
library(plyr)
library(rgdal)
library(plotrix)
library(tmap)
library(rgeos)
library(raster)
library(grid)
library(maps)
# bubble colors (first three numbers, 4th number is transparency .3 = 30% transparent)
# symbol.bg=rgb(1,1,0,0.3) = yellowish
# symbol.bg=rgb(1,0,0,0.3) = red
# (1,0,1) = purple
# (0,1,1) = electric blue
# (0,0,1) = royal blue
grid# clear workspace
rm(list=ls())
# clear graphics
graphics.off()
# read in data
load("D:/CRED/fish_cruise_routine_report/monitoring_report/2017_status_report/data/Data Outputs/working site data CAPPED.rdata") # loads as 'wsd'
############## Johnston,Howland, Baker ############
# Get relevant data
head(wsd)
sam<-wsd[wsd$REGION=="SAMOA",]
sam<-sam[sam$ANALYSIS_YEAR==2015,]
sam<-droplevels(sam)
#reading in shapefiles (uses maptools)
island <- importShapefile("D:/CRED/GIS/Common shapefiles/islands.shp")
# get bounding limits for each island
ext=read.csv("D:/CRED/fish_team_R/web based stuff/island_extents_for_R_maps.csv")
graphics.off()
#
# Set up 3 windows, one for each island. Joh bigger on top, then bak how under
#create matrix
mat <- matrix(c(1,2,
1,2,
3,4),nrow=2,ncol=3)
mat
#par(mar=c(0,0,0,0), oma=c(0,0,0,0))
layout(mat=mat)
# #max.h<-c(x,x,x,x) #set manually
# layout(mat=mat,widths=c(1,1),
#        heights=c(1,1))
# layout.show(3)
#layout(mat=mat)
#check margins:
par("mar")
par(mar=c(1,1,0,0), oma=c(0,0,0,0))
# TAU
plotMap(island,xlim=c(-169.537, -169.4), ylim=c(-14.282, -14.204),col="gray",bg="lightblue", axes=F,xlab="",ylab="", projection = TRUE, plt = c(.01, .99, .01, .8), polyProps = NULL)#,tckLab=T)
title(main="Tau", line=-1.0, cex=1.5)
#points(pch=21,mhi$LONGITUDE, mhi$LATITUDE,col="red",cex=1)
addBubbles(data.frame(EID=1:length(sam$LONGITUDE),
X=sam$LONGITUDE, Y=sam$LATITUDE, Z=sam$TotFish),
z.max=470, legend.title=expression(paste(" Biomass (g ", m^-2,")",sep="")),max.size=0.6,
symbol.fg=rgb(0,0,0,0.6), symbol.bg=rgb(1,0,0,0.3),legend.cex=0.9)
#OFU
plotMap(island,xlim=c(-169.697, -169.591), ylim=c(-14.201, -14.14),col="gray",bg="lightblue", axes=F,xlab="",ylab="",projection = TRUE, plt = c(.01, .99, .25, .99), polyProps = NULL)
title(main="Ofu and Olosega",line=-1.0, cex=1.5)
#points(pch=21,mhi$LONGITUDE, mhi$LATITUDE,col="red",cex=1)
addBubbles(data.frame(EID=1:length(sam$LONGITUDE),
X=sam$LONGITUDE, Y=sam$LATITUDE, Z=sam$TotFish),
z.max=470, max.size=0.6,legend.pos ="none",
symbol.fg=rgb(0,0,0,0.6), symbol.bg=rgb(1,0,0,0.3))
# !!! Error ok: object 'legend.loc' not found
# ROS:
plotMap(island,xlim=c(-168.179, -168.13), ylim=c(-14.563, -14.523),col="gray",bg="lightblue", axes=F,xlab="",ylab="",projection = TRUE, plt = c(.01, .99, .01, .89), polyProps = NULL)
title(main="Rose",line=-1.0, cex=1.5)
#points(pch=21,mhi$LONGITUDE, mhi$LATITUDE,col="red",cex=1)
addBubbles(data.frame(EID=1:length(sam$LONGITUDE),
X=sam$LONGITUDE, Y=sam$LATITUDE, Z=sam$TotFish),
z.max=470, legend.pos ="none",max.size=0.6,
symbol.fg=rgb(0,0,0,0.6), symbol.bg=rgb(1,0,0,0.3))
# SWA:
plotMap(island,xlim=c(-171.101, -171.056), ylim=c(-11.073, -11.037),col="gray",bg="lightblue", axes=F,xlab="",ylab="",projection = TRUE, plt = c(.01, .99, .11, .99), polyProps = NULL)
title(main="Swains",line=-1.0, cex=1.5)
#points(pch=21,mhi$LONGITUDE, mhi$LATITUDE,col="red",cex=1)
addBubbles(data.frame(EID=1:length(sam$LONGITUDE),
X=sam$LONGITUDE, Y=sam$LATITUDE, Z=sam$TotFish),
z.max=470, legend.pos ="none",max.size=0.6,
symbol.fg=rgb(0,0,0,0.6), symbol.bg=rgb(1,0,0,0.3))
library(ggplot2)
library(plyr)
library(scales)
library(reshape)           # reshape library includes the cast() function used below
require(RColorBrewer)
load("D:/CRED/PRIMNM_REPORT/data/PRIA Tow Data.Rdata")
load("D:/CRED/PRIMNM_REPORT/data/PRIA Tow Data.R")
load("D:/CRED/PRIMNM_REPORT/data/PRIA Data By Island and Year 10-20m min 500m Tows.Rdata")
wd<-as.data.frame(isd)
head(wd)
load("D:\CRED\fish_cruise_routine_report\monitoring_report\2017_status_report\data\Data Outputs/clean_working_site_data_used_in_higher_pooling_for_report.Rdata")
load("D:/CRED/fish_cruise_routine_report/monitoring_report/2017_status_report/data/Data Outputs/clean_working_site_data_used_in_higher_pooling_for_report.Rdata")
head(wsd.uncap)
write.csv(wsd.uncap,file="D:/CRED/fish_cruise_routine_report/monitoring_report/2017_status_report/data/Data Outputs/clean_working_site_data_used_in_higher_pooling_for_report.csv")
source("fish_team_functions.R")
setwd("D:/CRED/fish_team_R/fish-paste/lib")
source("fish_team_functions.R")
so
View(divervsdiver4)
